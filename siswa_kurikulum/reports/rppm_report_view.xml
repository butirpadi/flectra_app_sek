<odoo>
    <data>

        <record id="format_rppm_report" model="report.paperformat">
            <field name="name">RPPM Report</field>
            <field name="default" eval="True"/>
            <field name="format">A4</field>
            <field name="orientation">Landscape</field>
            <field name="margin_top">8</field>
            <field name="margin_bottom">8</field>
            <field name="margin_left">8</field>
            <field name="margin_right">8</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">3</field>
        </record>

        <report id="rppm_report_action" model="siswa.rppm" string="RPPM" report_type="qweb-html" name="siswa_kurikulum.rppm_report" file="siswa_kurikulum.rppm_report" attachment_use="False" print_report_name="'RPPM-%s' % (object.name )" menu="False" paperformat="format_rppm_report" />

        <template id="rppm_report">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.basic_layout">
                        <div class="page">
                            <style>
                                body{
                                    font-size:10pt;
                                }
                                table.table, table.table tbody tr td{
                                    background-color:transparent!important;
                                }

                                table.table.noborder, table.table.noborder tbody tr td{
                                    border:none!important;
                                    padding:0;
                                    margin:0;
                                }
                                table.table.noborder tbody tr td label{
                                    margin:0;
                                    padding:0;
                                }
                            </style>
                            <div class="row">
                                <div class="col-xs-2">
                                    <t t-if="user.company_id.report_logo">
                                        <span t-field="user.company_id.report_logo" t-field-options='{"widget": "image"}' />
                                    </t>
                                    <t t-if="not user.company_id.report_logo">
                                        <img src='/web/binary/company_logo' style="max-height:60px" />
                                    </t>
                                </div>
                                <div class="col-xs-10">
                                    <h5 style="margin:0;padding:0;">
                                        <strong>RENCANA PELAKSANAAN PEMBELAJARAN MINGGUAN</strong>
                                    </h5>
                                    <p style="margin:0;padding:0;font-weight:bold;" >
                                        <t t-esc="user.company_id.name" />
                                    </p>
                                    <p style="margin:0;padding:0;font-weight:bold;" >
                                        <t t-esc="user.company_id.report_header" />
                                    </p>
                                    <small style="margin:0;padding:0;" >
                                        <t t-esc="user.company_id.street" />
                                        <t t-esc="user.company_id.street2" />
                                        <t t-esc="user.company_id.city" />
                                        (<t t-esc="user.company_id.phone" />)
                                    </small>
                                </div>
                                <div class="col-xs-12">
                                    <hr style="border-top: 4px double black;margin:0;margin-top:5px;margin-bottom:5px;" />
                                    <table class="table noborder table-condensed">
                                        <tbody>
                                            <tr>
                                                <td class="col-xs-2">
                                                    <label>Tahun Ajaran</label>
                                                </td>
                                                <td style="width:10px;">:</td>
                                                <td>
                                                    <span t-field="o.tahunajaran_id"/>
                                                </td>
                                                <td class="col-xs-2">
                                                    <label>Kelompok</label>
                                                </td>
                                                <td style="width:10px;">:</td>
                                                <td>
                                                    <span t-field="o.jenjang_id"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <label>Semester</label>
                                                </td>
                                                <td>:</td>
                                                <td>
                                                    <span t-field="o.semester"/>
                                                </td>
                                                <td>
                                                    <label>Tema</label>
                                                </td>
                                                <td>:</td>
                                                <td>
                                                    <span t-field="o.tema"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <label>Periode</label>
                                                </td>
                                                <td>:</td>
                                                <td>
                                                    <span t-field="o.periode_awal"/>
 -
                                                    <span t-field="o.periode_akhir"/>
                                                </td>
                                                <td>
                                                    <label>Subtema</label>
                                                </td>
                                                <td>:</td>
                                                <td>
                                                    <span t-field="o.subtema"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <label>Materi</label>
                                                </td>
                                                <td>:</td>
                                                <td colspan="4">
                                                    <span t-field="o.materi"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <label>Kompetensi Dasar</label>
                                                </td>
                                                <td>:</td>
                                                <td colspan="4">
                                                    <t t-foreach="o.kompetensi_dasar_ids" t-as="kom">
                                                        <t t-esc="kom.name" />,
                                                    </t>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <br/><![CDATA[&nbsp;]]>
                                    <table class="table table-bordered table-condensed">
                                        <thead>
                                            <tr>
                                                <th style="width:40px;">NO</th>
                                                <th>TANGGAL</th>
                                                <t t-foreach="o.rppm_setting_id.kategori_muatan_ids" t-as="col">
                                                    <th class="text-center">
                                                        <t t-esc="col.kategori_muatan_id.name"/>
                                                    </th>
                                                </t>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-set="hari" t-value="['Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu']" />
                                            <t t-set="row_num" t-value="1" />
                                            <t t-foreach="o.muatan_materi_ids" t-as="row">
                                                <tr>
                                                    <td>
                                                        <t t-esc="row_num" />
                                                        <t t-set="row_num" t-value="row_num+1" />
                                                    </td>
                                                    <td>
                                                        <t t-esc="hari[int(time.strftime('%w',time.strptime(row.tanggal,'%Y-%m-%d')))]" />
                                                        <span t-field="row.tanggal" t-field-options='{"format": ", dd MMMM y"}' />
                                                        <!-- <span t-esc="time.strftime('%A, %d %B %Y',time.strptime(row.tanggal,'%Y-%m-%d'))"/> -->
                                                    </td>
                                                    <t t-foreach="o.rppm_setting_id.kategori_muatan_ids" t-as="col">
                                                        <td>
                                                            <t t-foreach="row.base_muatan_materi_ids" t-as="mat">
                                                                <t t-if="mat.kategori_id.id == col.kategori_muatan_id.id">
                                                                    <p>
                                                                        <t t-esc="mat.name" />
                                                                        <t t-esc="mat.desc" />
                                                                    </p>
                                                                </t>
                                                            </t>
                                                        </td>
                                                    </t>
                                                </tr>
                                            </t>
                                            <!-- <t t-foreach="o.rppm_setting_id.kategori_muatan_ids" t-as="col">
                                            </t> -->
                                        </tbody>
                                    </table>

                                    <table class="table noborder" >
                                        <tbody>
                                            <tr>
                                                <td class="col-xs-4 text-center" ></td>
                                                <td class="col-xs-4 text-center" ></td>
                                                <td class="col-xs-4 text-center" >
                                                    <t t-esc="user.company_id.city" />,<span t-field="o.tanggal" t-field-options='{"format": " dd MMMM y"}' />
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="text-center" >
                                                    <label>
                                                        <t t-esc="o.rppm_setting_id.first_job_id.name" />
                                                    </label>
                                                    <br/><![CDATA[&nbsp;]]>
                                                    <br/><![CDATA[&nbsp;]]>
                                                    <br/><![CDATA[&nbsp;]]>
                                                    <br/><![CDATA[&nbsp;]]>
                                                    <br/><![CDATA[&nbsp;]]>
                                                    <t t-esc="o.rppm_setting_id.first_approval_id.name" />
                                                </td>
                                                <td></td>
                                                <td class="text-center">
                                                    <label>
                                                        <t t-esc="o.employee_id.job_id.name" />
                                                    </label>
                                                    <br/><![CDATA[&nbsp;]]>
                                                    <br/><![CDATA[&nbsp;]]>
                                                    <br/><![CDATA[&nbsp;]]>
                                                    <br/><![CDATA[&nbsp;]]>
                                                    <br/><![CDATA[&nbsp;]]>
                                                    <t t-esc="o.employee_id.name" />
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="footer" >
                            <span>Page </span><span class="page" /> of <span class="topage" />
                            <div class="pull-right" >
                                <p><t t-esc="o.name"/> </p>
                            </div>
                        </div>
                    </t>
                </t>
            </t>
        </template>

    </data>
</odoo>