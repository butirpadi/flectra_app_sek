<odoo>
    <data>

        <record id="format_form_presensi_monthly_siswa" model="report.paperformat">
            <field name="name">Report Bukti Pembayaran</field>
            <field name="default" eval="True"/>
            <field name="format">A4</field>
            <field name="orientation">Landscape</field>
            <field name="margin_top">10</field>
            <field name="margin_bottom">10</field>
            <field name="margin_left">10</field>
            <field name="margin_right">10</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">3</field>
        </record>

        <report id="report_form_presensi_monthly_action" model="siswa_ocb11.wizard_report_form_presensi" string="Form Presensi" report_type="qweb-html" name="siswa_ocb11.report_form_presensi_monthly" file="siswa_ocb11.report_form_presensi_monthly" attachment_use="False" print_report_name="'FormPresensiSiswa-%s' % (object.tahunajaran_id.name + '-' + object.rombel_id.name)" menu="False" paperformat="siswa_ocb11.format_form_presensi_monthly_siswa" />

        <template id="report_form_presensi_monthly">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.basic_layout">
                        <div class="page">
                            <style>
                                table.table, table.table tbody tr td{
                                    background-color:transparent!important;
                                }

                                table.table.noborder, table.table.noborder tbody tr td{
                                    border:none!important;
                                    padding:0;
                                    margin:0;
                                }
                            </style>
                            <div class="row">
                                <div class="col-xs-3">
                                    <t t-if="user.company_id.report_logo">
                                        <span t-field="user.company_id.report_logo" t-field-options='{"widget": "image"}' />
                                    </t>
                                    <t t-if="not user.company_id.report_logo">
                                        <img src='/web/binary/company_logo' style="max-height:60px" />
                                    </t>
                                </div>
                                <div class="col-xs-9">
                                    <h3 style="margin:0;padding:0;">
                                        <strong>DAFTAR PRESENSI SISWA</strong>
                                    </h3>
                                    <div class="row">
                                        <div class="col-xs-4">
                                            <table class="table noborder">
                                                <tbody>
                                                    <tr>
                                                        <td >Tahun Ajaran</td>
                                                        <td style="width:10px;" >:</td>
                                                        <td class="col-xs-4" >
                                                            <t t-esc="o.tahunajaran_id.name" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Rombongan Belajar</td>
                                                        <td>:</td>
                                                        <td>
                                                            <t t-esc="o.rombel_id.name" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Tanggal</td>
                                                        <td>:</td>
                                                        <td>
                                                            <span t-field="o.tanggal" t-esc-options='{"format": "dd MMMM y"}'/>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12">
                                    <hr style="border-top: 4px double black;" />
                                    <table class="table table-bordered table-condensed" style="font-size:10pt;">
                                        <thead>
                                            <tr>
                                                <th rowspan="2" style="width:50px;vertical-align:middle;">No</th>
                                                <th rowspan="2" class="text-center" style="vertical-align:middle;">
                                                    <t t-if="o.default_siswa_number=='nis'">
                                                        <strong>NIS</strong>
                                                    </t>
                                                    <t t-if="o.default_siswa_number=='induk'">
                                                        <strong>SISWA ID</strong>
                                                    </t>
                                                </th>
                                                <th rowspan="2" style="vertical-align:middle;">NAMA</th>

                                                <th t-att-colspan="o.last_day" class="text-center">
                                                    TANGGAL
                                                </th>
                                                <th colspan="4" class="text-center">
                                                    <strong>TOTAL</strong>
                                                </th>
                                            </tr>
                                            <tr>
                                                <t t-foreach="range(o.last_day)" t-as="day">
                                                    <th style="width:25px;" rowspan="2" class="text-center">
                                                        <t t-esc="day+1" />
                                                    </th>
                                                </t>
                                                <th style="width:25px;" class="text-center">H</th>
                                                <th style="width:25px;" class="text-center">I</th>
                                                <th style="width:25px;" class="text-center">S</th>
                                                <th style="width:25px;" class="text-center">A</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-set="t_index" t-value="1" />
                                            <t t-foreach="o.siswa_ids.sorted(key=lambda x: x.induk)" t-as="sis">
                                                <tr>
                                                    <td>
                                                        <span t-esc="t_index" />
                                                    </td>
                                                    <td class="text-center">
                                                        <t t-if="o.default_siswa_number=='nis'">
                                                            <span t-field="sis.nis" />
                                                        </t>
                                                        <t t-if="o.default_siswa_number=='induk'">
                                                            <span t-field="sis.induk" />
                                                        </t>
                                                    </td>
                                                    <td>
                                                        <span t-field="sis.name" />
                                                    </td>
                                                    <t t-foreach="range(o.last_day)" t-as="day">
                                                        <td></td>
                                                    </t>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                </tr>
                                                <t t-set="t_index" t-value="t_index+1" />
                                            </t>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </t>
                </t>
            </t>
        </template>

    </data>
</odoo>